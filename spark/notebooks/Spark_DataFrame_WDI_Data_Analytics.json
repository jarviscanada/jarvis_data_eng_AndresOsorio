{"paragraphs":[{"text":"%md\n# SparkSession\n\nA SparkSession is automatically created when you start up a Notebook (e.g. Zeppelin, Databricks)\n\n<img src=\"https://i.imgur.com/5Ai45fb.jpg\" width=500px>","user":"anonymous","dateUpdated":"2020-11-12T00:29:23+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":6,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{"0":{"graph":{"mode":"table","height":527.719,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>SparkSession</h1>\n<p>A SparkSession is automatically created when you start up a Notebook (e.g. Zeppelin, Databricks)</p>\n<img src=\"https://i.imgur.com/5Ai45fb.jpg\" width=500px>\n</div>"}]},"apps":[],"jobName":"paragraph_1605127407280_2127429150","id":"20200924-193240_1472050812","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-12T00:29:23+0000","dateFinished":"2020-11-12T00:29:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:267"},{"text":"%md\n## Scala SparkSession","user":"anonymous","dateUpdated":"2020-11-12T00:30:26+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605140932082_2112020620","id":"20201112-002852_715638094","dateCreated":"2020-11-12T00:28:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6842","dateFinished":"2020-11-12T00:30:24+0000","dateStarted":"2020-11-12T00:30:24+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Scala SparkSession</h2>\n</div>"}]}},{"text":"%spark\n\nspark","user":"anonymous","dateUpdated":"2020-11-12T00:24:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res2: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@67f483d3\n"}]},"apps":[],"jobName":"paragraph_1605127407281_-1576901598","id":"20200924-184153_664614999","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-11T20:43:43+0000","dateFinished":"2020-11-11T20:43:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:268"},{"text":"%md\n## PySpark SparkSession","user":"anonymous","dateUpdated":"2020-11-12T00:30:16+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605140970853_1038654199","id":"20201112-002930_789218008","dateCreated":"2020-11-12T00:29:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6987","dateFinished":"2020-11-12T00:30:16+0000","dateStarted":"2020-11-12T00:30:16+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>PySpark SparkSession</h2>\n</div>"}]}},{"text":"%spark.pyspark\n\nspark","user":"anonymous","dateUpdated":"2020-11-12T00:24:29+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.session.SparkSession object at 0x7f2ed85b3490>\n"}]},"apps":[],"jobName":"paragraph_1605127407282_1953363637","id":"20200924-184216_1856886640","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-11T20:43:46+0000","dateFinished":"2020-11-11T20:43:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:269"},{"text":"%md \n\n# Show DataFrame\n\n`df.show()` is the Spark native API that displays data but it's not pretty. \n\n`z.show(df)` is a Zeppelin build-in feature that allows you to show a df in a pretty way.","user":"anonymous","dateUpdated":"2020-11-12T00:33:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Show DataFrame</h1>\n<p><code>df.show()</code> is the Spark native API that displays data but it&rsquo;s not pretty. </p>\n<p><code>z.show(df)</code> is a Zeppelin build-in feature that allows you to show a df in a pretty way.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1605127407282_1576701265","id":"20200924-193529_188023260","dateCreated":"2020-11-11T20:43:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:270","dateFinished":"2020-11-12T00:33:03+0000","dateStarted":"2020-11-12T00:33:03+0000"},{"text":"%spark.pyspark\n\ntables_df = spark.sql(\"show tables\")\ntables_df.show()","user":"anonymous","dateUpdated":"2020-11-12T00:24:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------------+-----------+\n|database|      tableName|isTemporary|\n+--------+---------------+-----------+\n| default|wdi_csv_parquet|      false|\n+--------+---------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1605127407282_1284489908","id":"20200924-193839_1624951483","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-12T00:13:42+0000","dateFinished":"2020-11-12T00:13:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:271"},{"text":"%spark.pyspark\n\nz.show(tables_df)","user":"anonymous","dateUpdated":"2020-11-12T00:22:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":88,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database":"string","tableName":"string","isTemporary":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"database\ttableName\tisTemporary\ndefault\twdi_csv_parquet\tfalse\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1605127407283_732842243","id":"20200924-184243_46563422","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-11T20:45:12+0000","dateFinished":"2020-11-11T20:45:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:272"},{"text":"%md \n\n# Spark SQL vs Dataframe\n\n`%sql` is the SparkSQL interpreter\n\n`%spark.pyspark` is the PySpark interpreter\n\n`%spark` is the Spark Scala interpreter\n\nWe will mostly use SparkSQL and PySpark","user":"anonymous","dateUpdated":"2020-11-12T00:33:49+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":6,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Spark SQL vs Dataframe</h1>\n<p><code>%sql</code> is the SparkSQL interpreter</p>\n<p><code>%spark.pyspark</code> is the PySpark interpreter</p>\n<p><code>%spark</code> is the Spark Scala interpreter</p>\n<p>We will mostly use SparkSQL and PySpark</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1605127407283_2121875038","id":"20200924-194044_351534117","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-12T00:33:49+0000","dateFinished":"2020-11-12T00:33:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:273"},{"text":"%spark.pyspark\n\nfrom pyspark.sql.functions import *\n\nwdi_df = spark.sql(\"SELECT * FROM wdi_csv_parquet\")\nwdi_df = wdi_df.cache()\nwdi_df.printSchema()\nz.show(wdi_df.count())","user":"anonymous","dateUpdated":"2020-11-12T00:25:00+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- year: integer (nullable = true)\n |-- countryName: string (nullable = true)\n |-- countryCode: string (nullable = true)\n |-- indicatorName: string (nullable = true)\n |-- indicatorCode: string (nullable = true)\n |-- indicatorValue: float (nullable = true)\n\n21759413\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1605127407283_-208129811","id":"20200924-185805_1139438367","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-11T21:08:09+0000","dateFinished":"2020-11-11T21:08:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:274"},{"text":"%spark.pyspark\n\nz.show(wdi_df.select(\"*\").limit(10))","user":"anonymous","dateUpdated":"2020-11-12T00:20:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"year":"string","countryName":"string","countryCode":"string","indicatorName":"string","indicatorCode":"string","indicatorValue":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":93,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\tcountryName\tcountryCode\tindicatorName\tindicatorCode\tindicatorValue\nnull\tcountry_name\tcountry_code\tindicator_name\tindicator_code\tnull\n1960\tChad\tTCD\tAdjusted net enrolment rate, primary, both sexes (%)\tSE.PRM.TENR\t0.0\n1960\tChad\tTCD\tAgriculture, value added (annual % growth)\tNV.AGR.TOTL.KD.ZG\t0.0\n1960\tChad\tTCD\tAll education staff compensation, secondary (% of total expenditure in secondary public institutions)\tSE.XPD.MSEC.ZS\t0.0\n1960\tChad\tTCD\tAutomated teller machines (ATMs) (per 100,000 adults)\tFB.ATM.TOTL.P5\t0.0\n1960\tChad\tTCD\tAverage working hours of children, working only, ages 7-14 (hours per week)\tSL.TLF.0714.WK.TM\t0.0\n1960\tChad\tTCD\tBirth rate, crude (per 1,000 people)\tSP.DYN.CBRT.IN\t45.785\n1960\tChad\tTCD\tChildren in employment, self-employed, female (% of female children in employment, ages 7-14)\tSL.SLF.0714.FE.ZS\t0.0\n1960\tChad\tTCD\tCO2 emissions from liquid fuel consumption (kt)\tEN.ATM.CO2E.LF.KT\t55.005\n1960\tChad\tTCD\tCommitments, IDA (COM, current US$)\tDT.COM.MIDA.CD\t0.0\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=22"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1605130948857_-106880344","id":"20201111-214228_784915314","dateCreated":"2020-11-11T21:42:28+0000","dateStarted":"2020-11-11T21:43:51+0000","dateFinished":"2020-11-11T21:43:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:275"},{"text":"%md \n\n# Show Historical GDP for Canada","user":"anonymous","dateUpdated":"2020-11-12T00:25:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Show Historical GDP for Canada</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1605127407284_938904847","id":"20200924-194555_411298048","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-12T00:25:35+0000","dateFinished":"2020-11-12T00:25:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:276"},{"text":"%sql\n\nSELECT year, IndicatorValue as GDP\nFROM wdi_csv_parquet\nWHERE indicatorCode = 'NY.GDP.MKTP.KD.ZG' and countryName = 'Canada'\nORDER BY year LIMIT 10","user":"anonymous","dateUpdated":"2020-11-11T21:36:39+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"year":"string","GDP":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"year","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"GDP","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\tGDP\n1960\t0.0\n1961\t3.1632917\n1962\t7.1167793\n1963\t5.181776\n1964\t6.6994567\n1965\t6.636545\n1966\t6.584965\n1967\t2.9153104\n1968\t5.295342\n1969\t5.2600007\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1605127407284_230043074","id":"20200925-000736_1945332225","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-11T21:30:24+0000","dateFinished":"2020-11-11T21:30:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:277"},{"text":"%sql\n\nSELECT year, IndicatorValue as GDP\nFROM wdi_csv_parquet\nWHERE indicatorCode = 'NY.GDP.MKTP.KD.ZG' and countryName = 'Canada'\nORDER BY year","user":"anonymous","dateUpdated":"2020-11-12T00:27:37+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"year":"string","GDP":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"year","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"GDP","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\tGDP\n1960\t0.0\n1961\t3.1632917\n1962\t7.1167793\n1963\t5.181776\n1964\t6.6994567\n1965\t6.636545\n1966\t6.584965\n1967\t2.9153104\n1968\t5.295342\n1969\t5.2600007\n1970\t3.2556136\n1971\t4.1176577\n1972\t5.4458556\n1973\t6.964203\n1974\t3.6909876\n1975\t1.8229731\n1976\t5.1993027\n1977\t3.4582305\n1978\t3.9535913\n1979\t3.8049228\n1980\t2.162617\n1981\t3.5031195\n1982\t-3.202025\n1983\t2.5985727\n1984\t5.92535\n1985\t4.7340827\n1986\t2.1618156\n1987\t4.0964646\n1988\t4.429401\n1989\t2.323974\n1990\t0.15434603\n1991\t-2.1256921\n1992\t0.88297606\n1993\t2.6552358\n1994\t4.4934745\n1995\t2.6777084\n1996\t1.611048\n1997\t4.2798123\n1998\t3.8817592\n1999\t5.163211\n2000\t5.18269\n2001\t1.7708191\n2002\t3.0100162\n2003\t1.8022733\n2004\t3.085961\n2005\t3.2013822\n2006\t2.6234126\n2007\t2.0627477\n2008\t1.000361\n2009\t-2.9495876\n2010\t3.0835142\n2011\t3.141219\n2012\t1.7454723\n2013\t2.2180681\n2014\t2.4728925\n2015\t1.0782688\n2016\t0.0\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=16"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1605129827670_247619264","id":"20201111-212347_1987162495","dateCreated":"2020-11-11T21:23:47+0000","dateStarted":"2020-11-11T21:24:15+0000","dateFinished":"2020-11-11T21:24:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:278"},{"text":"%spark.pyspark\n\nwdi_canada_df = wdi_df.filter(col(\"indicatorCode\") == \"NY.GDP.MKTP.KD.ZG\").filter(col(\"countryName\") == \"Canada\")                            .select(\"year\", col(\"indicatorValue\").alias(\"GDP\"))\nz.show(wdi_canada_df.orderBy(\"year\").limit(10))","user":"anonymous","dateUpdated":"2020-11-11T21:39:45+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"year":"string","GDP":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"year","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"GDP","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\tGDP\n1960\t0.0\n1961\t3.1632917\n1962\t7.1167793\n1963\t5.181776\n1964\t6.6994567\n1965\t6.636545\n1966\t6.584965\n1967\t2.9153104\n1968\t5.295342\n1969\t5.2600007\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=20"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1605128227176_-690763095","id":"20201111-205707_11407308","dateCreated":"2020-11-11T20:57:07+0000","dateStarted":"2020-11-11T21:39:45+0000","dateFinished":"2020-11-11T21:39:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:279"},{"text":"%spark.pyspark\n\nz.show(wdi_canada_df.orderBy(\"year\"))","user":"anonymous","dateUpdated":"2020-11-12T00:27:38+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"year","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"GDP","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\tGDP\n1960\t0.0\n1961\t3.1632917\n1962\t7.1167793\n1963\t5.181776\n1964\t6.6994567\n1965\t6.636545\n1966\t6.584965\n1967\t2.9153104\n1968\t5.295342\n1969\t5.2600007\n1970\t3.2556136\n1971\t4.1176577\n1972\t5.4458556\n1973\t6.964203\n1974\t3.6909876\n1975\t1.8229731\n1976\t5.1993027\n1977\t3.4582305\n1978\t3.9535913\n1979\t3.8049228\n1980\t2.162617\n1981\t3.5031195\n1982\t-3.202025\n1983\t2.5985727\n1984\t5.92535\n1985\t4.7340827\n1986\t2.1618156\n1987\t4.0964646\n1988\t4.429401\n1989\t2.323974\n1990\t0.15434603\n1991\t-2.1256921\n1992\t0.88297606\n1993\t2.6552358\n1994\t4.4934745\n1995\t2.6777084\n1996\t1.611048\n1997\t4.2798123\n1998\t3.8817592\n1999\t5.163211\n2000\t5.18269\n2001\t1.7708191\n2002\t3.0100162\n2003\t1.8022733\n2004\t3.085961\n2005\t3.2013822\n2006\t2.6234126\n2007\t2.0627477\n2008\t1.000361\n2009\t-2.9495876\n2010\t3.0835142\n2011\t3.141219\n2012\t1.7454723\n2013\t2.2180681\n2014\t2.4728925\n2015\t1.0782688\n2016\t0.0\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1605129725313_526281722","id":"20201111-212205_1062602509","dateCreated":"2020-11-11T21:22:05+0000","dateStarted":"2020-11-11T21:22:14+0000","dateFinished":"2020-11-11T21:22:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:280"},{"text":"%md \n\n# Show GDP for Each County and Sort By Year","user":"anonymous","dateUpdated":"2020-11-12T00:26:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Show GDP for Each County and Sort By Year</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1605127407285_-2115248354","id":"20200924-195213_2033277524","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-12T00:26:04+0000","dateFinished":"2020-11-12T00:26:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:281"},{"text":"%sql\n\nSELECT countryname,\n       year,\n       indicatorcode,\n       indicatorvalue\nFROM wdi_csv_parquet\nWHERE indicatorcode = 'NY.GDP.MKTP.KD.ZG'\nDISTRIBUTE BY countryname\nSORT BY countryname, year\nLIMIT 10","user":"anonymous","dateUpdated":"2020-11-11T21:36:25+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"countryname":"string","year":"string","indicatorcode":"string","indicatorvalue":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"year","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"countryname","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"countryname\tyear\tindicatorcode\tindicatorvalue\nSouth Asia\t1960\tNY.GDP.MKTP.KD.ZG\t0.0\nSouth Asia\t1961\tNY.GDP.MKTP.KD.ZG\t4.1063704\nSouth Asia\t1962\tNY.GDP.MKTP.KD.ZG\t3.3139846\nSouth Asia\t1963\tNY.GDP.MKTP.KD.ZG\t5.378623\nSouth Asia\t1964\tNY.GDP.MKTP.KD.ZG\t7.6917124\nSouth Asia\t1965\tNY.GDP.MKTP.KD.ZG\t-1.0054449\nSouth Asia\t1966\tNY.GDP.MKTP.KD.ZG\t0.9817688\nSouth Asia\t1967\tNY.GDP.MKTP.KD.ZG\t6.4182982\nSouth Asia\t1968\tNY.GDP.MKTP.KD.ZG\t4.3628674\nSouth Asia\t1969\tNY.GDP.MKTP.KD.ZG\t5.9217205\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=19"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1605127407285_-1780991334","id":"20200925-000433_1826008639","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-11T21:31:56+0000","dateFinished":"2020-11-11T21:31:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:282"},{"text":"%spark.pyspark\n\nwdi_gdp_df = wdi_df.filter(col(\"indicatorCode\") == \"NY.GDP.MKTP.KD.ZG\")                                                                 .select(\"countryName\", \"year\", \"indicatorCode\", \"indicatorValue\")\n             \nz.show(wdi_gdp_df.filter(col(\"countryName\") == \"South Asia\").orderBy(\"year\").limit(10))","user":"anonymous","dateUpdated":"2020-11-11T21:53:40+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"countryName":"string","year":"string","indicatorCode":"string","indicatorValue":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"countryName\tyear\tindicatorCode\tindicatorValue\nSouth Asia\t1960\tNY.GDP.MKTP.KD.ZG\t0.0\nSouth Asia\t1961\tNY.GDP.MKTP.KD.ZG\t4.1063704\nSouth Asia\t1962\tNY.GDP.MKTP.KD.ZG\t3.3139846\nSouth Asia\t1963\tNY.GDP.MKTP.KD.ZG\t5.378623\nSouth Asia\t1964\tNY.GDP.MKTP.KD.ZG\t7.6917124\nSouth Asia\t1965\tNY.GDP.MKTP.KD.ZG\t-1.0054449\nSouth Asia\t1966\tNY.GDP.MKTP.KD.ZG\t0.9817688\nSouth Asia\t1967\tNY.GDP.MKTP.KD.ZG\t6.4182982\nSouth Asia\t1968\tNY.GDP.MKTP.KD.ZG\t4.3628674\nSouth Asia\t1969\tNY.GDP.MKTP.KD.ZG\t5.9217205\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=27"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1605130399306_-939891760","id":"20201111-213319_393480678","dateCreated":"2020-11-11T21:33:19+0000","dateStarted":"2020-11-11T21:53:40+0000","dateFinished":"2020-11-11T21:53:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:283"},{"text":"%md\n\n# Find the Highest GDP for Each Country","user":"anonymous","dateUpdated":"2020-11-12T00:35:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605127407287_-1594908398","id":"20200925-000950_546215538","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-12T00:35:08+0000","dateFinished":"2020-11-12T00:35:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:284","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Find the Highest GDP for Each Country</h1>\n</div>"}]}},{"text":"%sql\n\nSELECT wdi_csv_parquet.indicatorvalue AS value, \n       wdi_csv_parquet.year           AS year, \n       wdi_csv_parquet.countryname    AS country \nFROM   (SELECT Max(indicatorvalue) AS ind, \n               countryname \n        FROM   wdi_csv_parquet \n        WHERE  indicatorcode = 'NY.GDP.MKTP.KD.ZG' \n               AND indicatorvalue <> 0 \n        GROUP  BY countryname) t1 \n       INNER JOIN wdi_csv_parquet \n               ON t1.ind = wdi_csv_parquet.indicatorvalue \n                  AND t1.countryname = wdi_csv_parquet.countryname\n","user":"anonymous","dateUpdated":"2020-11-11T23:32:09+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"value":"string","year":"string","country":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"value\tyear\tcountry\n189.82993\t1965\tOman\n14.582442\t2007\tMonaco\n17.505634\t2000\tTimor-Leste\n19.560095\t1975\tMalta\n9.08357\t2010\tSouth Asia (IDA & IBRD)\n5.2550063\t1990\tGermany\n8.809809\t1986\tUruguay\n10.016272\t1970\tLate-demographic dividend\n12.344\t2007\tGeorgia\n6.5672135\t2006\tCentral Europe and the Baltics\n7.1167274\t1984\tNorth America\n21.200697\t1962\tCongo, Dem. Rep.\n15.106996\t1972\tMiddle East & North Africa\n25.027607\t1972\tSyrian Arab Republic\n8.1406555\t1993\tMicronesia, Fed. Sts.\n9.668261\t2006\tSmall states\n7.1668916\t1970\tAustralia\n9.849452\t2001\tPuerto Rico\n33.62937\t2004\tChad\n11.360282\t1964\tGuyana\n7.8144317\t1996\tAruba\n16.241957\t1968\tIsrael\n18.005667\t1970\tIDA blend\n11.730911\t1982\tMoldova\n6.645474\t1997\tCroatia\n11.353461\t1970\tPakistan\n13.060854\t1971\tGreenland\n23.171246\t1982\tIran, Islamic Rep.\n20.286634\t1985\tMali\n8.755049\t1973\tLatin America & the Caribbean (IDA & IBRD countries)\n34.31373\t1963\tAlgeria\n12.27793\t1992\tChile\n8.643095\t1965\tNetherlands\n14.040795\t2003\tArmenia\n8.618244\t2007\tLow & middle income\n9.227175\t1973\tLatin America & Caribbean (excluding high income)\n24.542517\t1986\tMarshall Islands\n13.833095\t1983\tVanuatu\n8.920647\t1973\tPhilippines\n6.275867\t1969\tAustria\n6.5399766\t1973\tUnited Kingdom\n6.6795015\t1984\tPacific island small states\n11.90548\t1964\tMexico\n13.160728\t1970\tEast Asia & Pacific (excluding high income)\n23.874775\t1980\tUnited Arab Emirates\n10.944692\t1988\tBulgaria\n12.393429\t1975\tGambia, The\n13.978692\t1973\tBrazil\n106.27981\t1997\tLiberia\n14.190637\t1989\tLao PDR\n27.690886\t1964\tMauritania\n5.8983297\t2007\tChannel Islands\n6.5584636\t1985\tTonga\n8.195589\t2004\tEurope & Central Asia (excluding high income)\n14.363636\t1966\tBermuda\n14.260685\t1980\tDominica\n8.645224\t2007\tMiddle income\n17.742718\t1972\tTunisia\n8.464381\t2007\tTanzania\n9.540481\t1995\tVietnam\n11.902191\t2006\tLatvia\n8.394322\t2004\tLower middle income\n9.481555\t1984\tCentral African Republic\n35.22408\t1995\tRwanda\n9.292035\t1995\tSan Marino\n11.149537\t1961\tGreece\n13.273064\t2005\tGrenada\n26.40488\t1973\tLesotho\n34.5\t2006\tAzerbaijan\n34.5\t2000\tAzerbaijan\n15.315924\t2007\tPanama\n9.742033\t1986\tMauritius\n13.129731\t2013\tSouth Sudan\n6.416388\t1993\tNew Zealand\n23.544891\t1990\tSt. Lucia\n14.036278\t2013\tParaguay\n19.688335\t1981\tCuba\n8.89603\t1965\tSouth Africa\n8.920504\t1976\tSenegal\n8.207598\t1992\tYemen, Rep.\n12.308128\t1994\tPeru\n14.787517\t1973\tKorea, Rep.\n6.308117\t1988\tGuinea\n6.7345076\t2010\tLow income\n10.583587\t1986\tSt. Kitts and Nevis\n15.240377\t2010\tSingapore\n7.9674854\t1972\tBolivia\n11.588021\t2004\tSub-Saharan Africa\n11.838675\t1961\tSpain\n6.9591\t2007\tIDA only\n9.8296175\t1965\tCosta Rica\n26.36194\t1972\tBotswana\n26.845322\t1996\tMozambique\n9.048841\t1972\tCaribbean small states\n9.144579\t2012\tSri Lanka\n12.1\t2015\tUkraine\n12.1\t1990\tUkraine\n12.1\t2000\tUkraine\n12.1\t1991\tUkraine\n12.1\t1990\tUkraine\n12.1\t1998\tUkraine\n12.1\t2016\tUkraine\n12.1\t1995\tUkraine\n12.1\t1992\tUkraine\n12.1\t1997\tUkraine\n12.1\t2004\tUkraine\n23.5977\t1982\tCongo, Rep.\n10.500693\t1976\tHonduras\n13.250086\t2005\tCambodia\n25.83149\t1972\tSt. Vincent and the Grenadines\n13.9\t2000\tTajikistan\n13.9\t2002\tTajikistan\n13.9\t1988\tTajikistan\n13.9\t1999\tTajikistan\n11.018513\t1989\tSuriname\n20.266293\t1976\tCyprus\n7.5433373\t1992\tEl Salvador\n16.66522\t1976\tSudan\n6.0001945\t2014\tDjibouti\n11.60034\t2004\tSub-Saharan Africa (excluding high income)\n11.645651\t1969\tEast Asia & Pacific\n22.003004\t1978\tCameroon\n10.410924\t1999\tLiechtenstein\n12.66971\t1991\tArgentina\n14.627248\t1976\tEgypt, Arab Rep.\n39.487095\t1974\tGabon\n15.916227\t1976\tMiddle East & North Africa (excluding high income)\n9.954231\t1981\tBenin\n12.896334\t1976\tArab World\n7.2016835\t2007\tPoland\n9.8546505\t1979\tMadagascar\n28.696266\t1987\tBhutan\n10.0\t1996\tRussian Federation\n10.0\t2012\tRussian Federation\n10.0\t2003\tRussian Federation\n10.0\t2005\tRussian Federation\n10.0\t2010\tRussian Federation\n10.0\t1999\tRussian Federation\n10.0\t2009\tRussian Federation\n10.0\t2000\tRussian Federation\n10.0\t2007\tRussian Federation\n10.0\t2002\tRussian Federation\n10.0\t1996\tRussian Federation\n10.0\t2004\tRussian Federation\n10.0\t2013\tRussian Federation\n10.0\t2002\tRussian Federation\n10.0\t2006\tRussian Federation\n10.0\t2008\tRussian Federation\n10.0\t2000\tRussian Federation\n10.0\t2006\tRussian Federation\n10.0\t2011\tRussian Federation\n10.0\t2010\tRussian Federation\n10.0\t1999\tRussian Federation\n10.0\t2000\tRussian Federation\n10.0\t2000\tRussian Federation\n10.0\t2001\tRussian Federation\n10.0\t2002\tRussian Federation\n10.0\t2014\tRussian Federation\n10.0\t2003\tRussian Federation\n10.0\t2001\tRussian Federation\n12.02392\t2003\tAndorra\n38.20071\t1991\tLebanon\n9.115646\t2006\tSao Tome and Principe\n10.952788\t1964\tBangladesh\n13.950682\t1973\tEcuador\n6.9535418\t1969\tEuro area\n149.97296\t1997\tEquatorial Guinea\n21.244144\t2004\tPre-demographic dividend\n24.309572\t1976\tJordan\n9.541044\t1963\tGuatemala\n8.692858\t2007\tIBRD only\n6.8927703\t1962\tHeavily indebted poor countries (HIPC)\n11.449743\t2004\tBelarus\n6.100627\t1973\tEuropean Union\n15.459713\t1965\tTogo\n15.50122\t1998\tTuvalu\n45.302753\t1974\tKiribati\n4.9377146\t2004\tHungary\n8.207246\t1961\tItaly\n6.5564966\t1964\tOECD members\n13.3764\t2006\tAntigua and Barbuda\n9.046513\t2004\tSerbia\n22.562428\t1979\tBrunei Darussalam\n10.657902\t2007\tMontenegro\n15.916227\t1976\tMiddle East & North Africa (IDA & IBRD countries)\n18.167528\t1981\tGuinea-Bissau\n13.5\t1999\tKazakhstan\n13.5\t1999\tKazakhstan\n13.5\t2012\tKazakhstan\n13.5\t2001\tKazakhstan\n13.5\t2014\tKazakhstan\n13.5\t2012\tKazakhstan\n13.5\t1999\tKazakhstan\n13.5\t1995\tKazakhstan\n33.990467\t1993\tKuwait\n22.173891\t1971\tKenya\n12.928475\t2011\tSolomon Islands\n17.613089\t1964\tCote d'Ivoire\n26.973917\t2001\tKosovo\n21.020649\t2009\tAfghanistan\n19.105537\t1986\tIsle of Man\n6.645997\t1964\tWorld\n18.001049\t1974\tFrench Polynesia\n14.441417\t2003\tTrinidad and Tobago\n11.588021\t2004\tSub-Saharan Africa (IDA & IBRD countries)\n18.008554\t1972\tJamaica\n13.288115\t1988\tThailand\n16.241243\t1990\tFragile and conflict affected situations\n16.647455\t1965\tZambia\n19.182642\t1994\tCabo Verde\n6.473487\t2007\tMacedonia, FYR\n25.947592\t1998\tWest Bank and Gaza\n7.1167793\t1962\tCanada\n10.583844\t2006\tOther small states\n26.754988\t2004\tMacao SAR, China\n6.821457\t1964\tSweden\n18.202286\t1993\tPapua New Guinea\n5.305203\t1994\tCayman Islands\n17.290777\t2011\tMongolia\n21.32567\t1970\tBurundi\n16.728817\t1995\tMalawi\n6.9905305\t1969\tFrance\n21.22141\t1994\tEritrea\n26.170246\t2006\tQatar\n5.6764426\t2006\tBarbados\n8.533192\t2007\tIDA & IBRD total\n11.229955\t2004\tIDA total\n9.921154\t2007\tUzbekistan\n11.523244\t1995\tUganda\n19.4\t2011\tChina\n19.4\t1970\tChina\n8.312726\t1964\tEarly-demographic dividend\n22.593054\t2007\tAngola\n6.466701\t1964\tPost-demographic dividend\n8.6221485\t1973\tLatin America & Caribbean\n14.046002\t2011\tGhana\n14.667397\t1972\tVirgin Islands (U.S.)\n26.139296\t1979\tBahamas, The\n104.486786\t2012\tLibya\n12.372876\t1996\tMorocco\n12.870007\t1993\tBahrain\n5.523738\t2011\tHaiti\n13.85933\t1987\tEthiopia\n8.458984\t2008\tRomania\n12.269548\t2004\tNamibia\n12.882468\t1968\tJapan\n11.212815\t1966\tTurkey\n13.351832\t1967\tFiji\n22.565151\t1970\tZimbabwe\n6.2733355\t1961\tNorway\n11.086954\t2007\tLithuania\n9.378625\t2007\tLeast developed countries: UN classification\n7.178966\t1996\tSamoa\n10.259963\t2010\tIndia\n13.472612\t1978\tNiger\n30.073698\t1975\tSomalia\n4.330794\t1989\tSwitzerland\n11.014744\t1996\tBurkina Faso\n10.9000435\t1995\tPalau\n16.164154\t1976\tHong Kong SAR, China\n8.46345\t1978\tColombia\n9.048979\t2007\tUpper middle income\n13.501173\t1999\tAlbania\n20.654325\t2006\tMaldives\n6.941572\t2007\tSlovenia\n21.018\t1990\tSwaziland\n18.226683\t1970\tDominican Republic\n33.735775\t2004\tNigeria\n22.672523\t1973\tSaudi Arabia\n11.714203\t1973\tMalaysia\n13.160728\t1970\tEast Asia & Pacific (IDA & IBRD countries)\n9.08357\t2010\tSouth Asia\n34.600002\t1988\tNew Caledonia\n9.269938\t1964\tDenmark\n9.593287\t1969\tFinland\n11.1779995\t1997\tIreland\n6.8765445\t2006\tCzech Republic\n10.848075\t2000\tComoros\n6.9566846\t1964\tBelgium\n12.612603\t1970\tPortugal\n13.843995\t2003\tMyanmar\n21.151693\t1978\tSeychelles\n7.7826047\t2006\tEurope & Central Asia (IDA & IBRD countries)\n10.834435\t2007\tSlovak Republic\n18.286606\t2004\tVenezuela, RB\n14.192425\t1974\tNicaragua\n6.008331\t1973\tEurope & Central Asia\n6.4625196\t1964\tHigh income\n12.034179\t1968\tIndonesia\n9.68113\t1984\tNepal\n9.983934\t1986\tLuxembourg\n7.259087\t1984\tUnited States\n13.060838\t1971\tIceland\n88.957664\t1996\tBosnia and Herzegovina\n35.38456\t1990\tTurkmenistan\n26.268576\t2002\tSierra Leone\n13.20003\t1988\tKyrgyz Republic\n11.798595\t1997\tEstonia\n15.166518\t1980\tBelize\n57.81783\t1990\tIraq\n"}]},"apps":[],"jobName":"paragraph_1605127407288_1716555330","id":"20200925-001035_102671005","dateCreated":"2020-11-11T20:43:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:285"},{"text":"%spark.pyspark\n\nhighest_gdp_country_df = wdi_df.filter(col(\"indicatorCode\") == \"NY.GDP.MKTP.KD.ZG\")                                                                   .filter(col(\"indicatorValue\") > 0)                                                                                           .groupBy(\"countryName\").agg(max(\"indicatorValue\").alias(\"gdp\"))                                                              .select(\"countryName\", \"gdp\")\n\nhighest_gdp_year_df = wdi_df.filter(col(\"indicatorCode\") == \"NY.GDP.MKTP.KD.ZG\")                                                                   .filter(col(\"indicatorValue\") > 0)                                                                                           .select(\"year\", col(\"indicatorValue\").alias(\"gdp\"))\n\nhighest_gdp_year_country = highest_gdp_country_df.join(highest_gdp_year_df, \"gdp\")                                                                         .select(col(\"gdp\").alias(\"highest_gdp\"), \"year\", \"countryName\")\n\nz.show(highest_gdp_year_country)","user":"anonymous","dateUpdated":"2020-11-12T00:09:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"highest_gdp":"string","year":"string","countryName":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"highest_gdp\tyear\tcountryName\n7.259087\t1984\tUnited States\n22.173891\t1971\tKenya\n11.014744\t1996\tBurkina Faso\n11.086954\t2007\tLithuania\n12.870007\t1993\tBahrain\n19.182642\t1994\tCabo Verde\n21.020649\t2009\tAfghanistan\n189.82993\t1965\tOman\n6.100627\t1973\tEuropean Union\n7.1668916\t1970\tAustralia\n26.40488\t1973\tLesotho\n6.0001945\t2014\tDjibouti\n6.5584636\t1985\tTonga\n7.178966\t1996\tSamoa\n4.330794\t1989\tSwitzerland\n11.360282\t1964\tGuyana\n23.874775\t1980\tUnited Arab Emirates\n7.1167793\t1962\tCanada\n21.018\t1990\tSwaziland\n7.9674854\t1972\tBolivia\n7.2016835\t2007\tPoland\n12.612603\t1970\tPortugal\n22.593054\t2007\tAngola\n12.02392\t2003\tAndorra\n8.618244\t2007\tLow & middle income\n16.164154\t1976\tHong Kong SAR, China\n26.170246\t2006\tQatar\n26.754988\t2004\tMacao SAR, China\n26.845322\t1996\tMozambique\n6.6795015\t1984\tPacific island small states\n8.1406555\t1993\tMicronesia, Fed. Sts.\n10.944692\t1988\tBulgaria\n23.544891\t1990\tSt. Lucia\n5.2550063\t1990\tGermany\n9.540481\t1995\tVietnam\n13.3764\t2006\tAntigua and Barbuda\n19.560095\t1975\tMalta\n4.9377146\t2004\tHungary\n6.275867\t1969\tAustria\n13.060838\t1971\tIceland\n6.941572\t2007\tSlovenia\n11.018513\t1989\tSuriname\n10.500693\t1976\tHonduras\n34.5\t2006\tAzerbaijan\n8.920504\t1976\tSenegal\n8.312726\t1964\tEarly-demographic dividend\n11.212815\t1966\tTurkey\n13.833095\t1983\tVanuatu\n13.160728\t1970\tEast Asia & Pacific (IDA & IBRD countries)\n13.160728\t1970\tEast Asia & Pacific (IDA & IBRD countries)\n13.160728\t1970\tEast Asia & Pacific (excluding high income)\n13.160728\t1970\tEast Asia & Pacific (excluding high income)\n5.523738\t2011\tHaiti\n14.363636\t1966\tBermuda\n12.882468\t1968\tJapan\n21.22141\t1994\tEritrea\n8.464381\t2007\tTanzania\n9.921154\t2007\tUzbekistan\n21.151693\t1978\tSeychelles\n9.541044\t1963\tGuatemala\n15.240377\t2010\tSingapore\n22.672523\t1973\tSaudi Arabia\n6.5672135\t2006\tCentral Europe and the Baltics\n16.728817\t1995\tMalawi\n23.171246\t1982\tIran, Islamic Rep.\n17.290777\t2011\tMongolia\n22.565151\t1970\tZimbabwe\n22.003004\t1978\tCameroon\n6.9905305\t1969\tFrance\n20.654325\t2006\tMaldives\n34.31373\t1963\tAlgeria\n6.473487\t2007\tMacedonia, FYR\n6.645997\t1964\tWorld\n10.848075\t2000\tComoros\n12.034179\t1968\tIndonesia\n13.843995\t2003\tMyanmar\n5.6764426\t2006\tBarbados\n8.920647\t1973\tPhilippines\n14.046002\t2011\tGhana\n14.190637\t1989\tLao PDR\n27.690886\t1964\tMauritania\n6.8765445\t2006\tCzech Republic\n13.351832\t1967\tFiji\n24.542517\t1986\tMarshall Islands\n19.688335\t1981\tCuba\n15.166518\t1980\tBelize\n9.048979\t2007\tUpper middle income\n21.244144\t2004\tPre-demographic dividend\n9.8296175\t1965\tCosta Rica\n34.600002\t1988\tNew Caledonia\n12.1\t2004\tUkraine\n10.0\t2000\tRussian Federation\n10.0\t2006\tRussian Federation\n10.0\t1983\tRussian Federation\n10.0\t1998\tRussian Federation\n10.0\t2008\tRussian Federation\n11.229955\t2004\tIDA total\n13.85933\t1987\tEthiopia\n22.562428\t1979\tBrunei Darussalam\n12.928475\t2011\tSolomon Islands\n10.410924\t1999\tLiechtenstein\n7.5433373\t1992\tEl Salvador\n9.048841\t1972\tCaribbean small states\n8.207246\t1961\tItaly\n8.458984\t2008\tRomania\n14.192425\t1974\tNicaragua\n13.20003\t1988\tKyrgyz Republic\n38.20071\t1991\tLebanon\n33.62937\t2004\tChad\n15.106996\t1972\tMiddle East & North Africa\n8.46345\t1978\tColombia\n10.016272\t1970\tLate-demographic dividend\n10.9000435\t1995\tPalau\n18.202286\t1993\tPapua New Guinea\n9.742033\t1986\tMauritius\n11.60034\t2004\tSub-Saharan Africa (excluding high income)\n11.1779995\t1997\tIreland\n19.105537\t1986\tIsle of Man\n18.001049\t1974\tFrench Polynesia\n25.83149\t1972\tSt. Vincent and the Grenadines\n6.416388\t1993\tNew Zealand\n15.459713\t1965\tTogo\n6.5399766\t1973\tUnited Kingdom\n18.008554\t1972\tJamaica\n13.950682\t1973\tEcuador\n13.978692\t1973\tBrazil\n9.668261\t2006\tSmall states\n17.742718\t1972\tTunisia\n7.1167274\t1984\tNorth America\n45.302753\t1974\tKiribati\n13.129731\t2013\tSouth Sudan\n9.593287\t1969\tFinland\n15.916227\t1976\tMiddle East & North Africa (IDA & IBRD countries)\n15.916227\t1976\tMiddle East & North Africa (IDA & IBRD countries)\n15.916227\t1976\tMiddle East & North Africa (excluding high income)\n15.916227\t1976\tMiddle East & North Africa (excluding high income)\n11.714203\t1973\tMalaysia\n14.036278\t2013\tParaguay\n8.692858\t2007\tIBRD only\n10.952788\t1964\tBangladesh\n16.647455\t1965\tZambia\n14.260685\t1980\tDominica\n14.582442\t2007\tMonaco\n21.200697\t1962\tCongo, Dem. Rep.\n15.50122\t1998\tTuvalu\n20.266293\t1976\tCyprus\n9.68113\t1984\tNepal\n8.755049\t1973\tLatin America & the Caribbean (IDA & IBRD countries)\n12.66971\t1991\tArgentina\n6.821457\t1964\tSweden\n6.9566846\t1964\tBelgium\n14.667397\t1972\tVirgin Islands (U.S.)\n9.481555\t1984\tCentral African Republic\n106.27981\t1997\tLiberia\n13.501173\t1999\tAlbania\n14.040795\t2003\tArmenia\n8.809809\t1986\tUruguay\n11.902191\t2006\tLatvia\n5.305203\t1994\tCayman Islands\n8.6221485\t1973\tLatin America & Caribbean\n9.983934\t1986\tLuxembourg\n16.241957\t1968\tIsrael\n23.5977\t1982\tCongo, Rep.\n16.241243\t1990\tFragile and conflict affected situations\n20.286634\t1985\tMali\n14.627248\t1976\tEgypt, Arab Rep.\n11.149537\t1961\tGreece\n12.393429\t1975\tGambia, The\n33.990467\t1993\tKuwait\n33.735775\t2004\tNigeria\n8.89603\t1965\tSouth Africa\n15.315924\t2007\tPanama\n9.115646\t2006\tSao Tome and Principe\n30.073698\t1975\tSomalia\n7.7826047\t2006\tEurope & Central Asia (IDA & IBRD countries)\n149.97296\t1997\tEquatorial Guinea\n11.523244\t1995\tUganda\n19.4\t1970\tChina\n9.954231\t1981\tBenin\n9.269938\t1964\tDenmark\n10.259963\t2010\tIndia\n10.583587\t1986\tSt. Kitts and Nevis\n10.583844\t2006\tOther small states\n6.008331\t1973\tEurope & Central Asia\n9.292035\t1995\tSan Marino\n14.441417\t2003\tTrinidad and Tobago\n26.36194\t1972\tBotswana\n39.487095\t1974\tGabon\n35.22408\t1995\tRwanda\n6.9535418\t1969\tEuro area\n21.32567\t1970\tBurundi\n104.486786\t2012\tLibya\n26.139296\t1979\tBahamas, The\n57.81783\t1990\tIraq\n6.9591\t2007\tIDA only\n7.8144317\t1996\tAruba\n13.9\t1988\tTajikistan\n13.273064\t2005\tGrenada\n9.849452\t2001\tPuerto Rico\n11.798595\t1997\tEstonia\n11.838675\t1961\tSpain\n13.250086\t2005\tCambodia\n9.144579\t2012\tSri Lanka\n12.269548\t2004\tNamibia\n6.645474\t1997\tCroatia\n8.195589\t2004\tEurope & Central Asia (excluding high income)\n10.834435\t2007\tSlovak Republic\n13.288115\t1988\tThailand\n5.8983297\t2007\tChannel Islands\n35.38456\t1990\tTurkmenistan\n12.27793\t1992\tChile\n11.90548\t1964\tMexico\n18.226683\t1970\tDominican Republic\n11.449743\t2004\tBelarus\n11.730911\t1982\tMoldova\n13.5\t2001\tKazakhstan\n8.207598\t1992\tYemen, Rep.\n25.027607\t1972\tSyrian Arab Republic\n8.533192\t2007\tIDA & IBRD total\n12.896334\t1976\tArab World\n9.046513\t2004\tSerbia\n12.372876\t1996\tMorocco\n17.613089\t1964\tCote d'Ivoire\n24.309572\t1976\tJordan\n6.4625196\t1964\tHigh income\n6.7345076\t2010\tLow income\n6.466701\t1964\tPost-demographic dividend\n9.08357\t2010\tSouth Asia (IDA & IBRD)\n9.08357\t2010\tSouth Asia (IDA & IBRD)\n9.08357\t2010\tSouth Asia\n9.08357\t2010\tSouth Asia\n9.8546505\t1979\tMadagascar\n16.66522\t1976\tSudan\n28.696266\t1987\tBhutan\n88.957664\t1996\tBosnia and Herzegovina\n6.2733355\t1961\tNorway\n8.394322\t2004\tLower middle income\n12.344\t2007\tGeorgia\n10.657902\t2007\tMontenegro\n6.5564966\t1964\tOECD members\n11.353461\t1970\tPakistan\n12.308128\t1994\tPeru\n17.505634\t2000\tTimor-Leste\n6.8927703\t1962\tHeavily indebted poor countries (HIPC)\n13.472612\t1978\tNiger\n26.268576\t2002\tSierra Leone\n26.973917\t2001\tKosovo\n11.645651\t1969\tEast Asia & Pacific\n25.947592\t1998\tWest Bank and Gaza\n6.308117\t1988\tGuinea\n8.643095\t1965\tNetherlands\n9.227175\t1973\tLatin America & Caribbean (excluding high income)\n13.060854\t1971\tGreenland\n18.167528\t1981\tGuinea-Bissau\n11.588021\t2004\tSub-Saharan Africa\n11.588021\t2004\tSub-Saharan Africa\n11.588021\t2004\tSub-Saharan Africa (IDA & IBRD countries)\n11.588021\t2004\tSub-Saharan Africa (IDA & IBRD countries)\n18.005667\t1970\tIDA blend\n8.645224\t2007\tMiddle income\n9.378625\t2007\tLeast developed countries: UN classification\n14.787517\t1973\tKorea, Rep.\n18.286606\t2004\tVenezuela, RB\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=33","http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=34","http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=35","http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=36","http://jarvis-bootcamp-m.us-east1-d.c.strange-vortex-281923.internal:4040/jobs/job?id=37"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1605127407289_1080019605","id":"20200925-001040_676373300","dateCreated":"2020-11-11T20:43:27+0000","dateStarted":"2020-11-12T00:09:15+0000","dateFinished":"2020-11-12T00:09:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:286"}],"name":"Spark Dataframe - WDI Data Analytics","id":"2FRWJKJH4","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}